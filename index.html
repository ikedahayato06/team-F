<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
   <title>Sample Map</title>
   <script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAMb-nfDy9Nw5rxM7k9e7D8BiBZi2Wrciw&callback=initMap">
   </script>

   <style type="text/css">
      #map_canvas {
         width: 100%;
         height: 50%;
      }
      html, body {
         height: 100%;
         margin: 0;
         padding: 0;
      }
   </style>
   <script type="text/javascript">
      var map;
      var marker;
      var circle;
      var id;

      function initMap() {
         var myLatlng = new google.maps.LatLng(35.683755, 139.745625);
         var mapOptions = {
           zoom: 14,
           center: myLatlng
         }
         map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

         // CSVデータのURL
         var csvDataUrl = "https://github.com/project-team-F/team-F/blob/main/data.csv";

         // CSVデータを読み込む
         fetch(csvDataUrl)
            .then(response => response.text())
            .then(data => {
               // CSVデータを処理
               processData(data);
            })
            .catch(error => console.error("Error fetching CSV data: " + error));
      }

      function processData(csvData) {
         // CSVデータをパース
         var lines = csvData.split("\n");
         for (var i = 1; i < lines.length; i++) { // 最初の行はヘッダーなのでスキップ
            var line = lines[i].split(",");
            var timestamp = line[0];
            var latitude = parseFloat(line[1]);
            var longitude = parseFloat(line[2]);
            var accuracy = parseFloat(line[3]);

            // マーカーを設定
            var location = new google.maps.LatLng(latitude, longitude);
            var newMarker = new google.maps.Marker({ position: location, map: map });
         }
      }

      // 他の関数（success、error、setInfo、startWatchPosition、clearWatchPosition）は変更なし
   </script>
</head>
<body>
   <div id="map_canvas"></div>
   <br /><input type="button" value="追跡開始" onclick="startWatchPosition();" />
   <br /><input type="button" value="追跡終了" onclick="clearWatchPosition();" />
   <p>
      <table style="width:100%">
         <tr><th>エラーコード</th><td id="tdErrCd"></td></tr>
         <tr><th>エラーメッセージ</th><td id="tdErrMg"></td></tr>
      </table>
      <table style="width:100%" id="tblGps">
         <tr>
            <th>タイムスタンプ</th>
            <th>緯度</th>
            <th>経度</th>
            <th>位置（正確さ）</th>
         </tr>
      </table>
   </p>
</body>
</html>
